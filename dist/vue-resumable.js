!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("VueResumable",[],t):"object"==typeof exports?exports.VueResumable=t():e.VueResumable=t()}("undefined"!=typeof self?self:this,function(){return function(e){function t(i){if(n[i])return n[i].exports;var r=n[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/dist/",t(t.s=3)}([function(e,t){e.exports=function(e,t,n,i,r,a){var o,s=e=e||{},u=typeof e.default;"object"!==u&&"function"!==u||(o=e,s=e.default);var c="function"==typeof s?s.options:s;t&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0),n&&(c.functional=!0),r&&(c._scopeId=r);var l;if(a?(l=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},c._ssrRegister=l):i&&(l=i),l){var d=c.functional,h=d?c.render:c.beforeCreate;d?(c._injectStyles=l,c.render=function(e,t){return l.call(t),h(e,t)}):c.beforeCreate=h?[].concat(h,l):[l]}return{esModule:o,exports:s,options:c}}},function(e,t,n){"use strict";function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var r=n(5),a=n(7),o=n(8),s=n(9);t.a={name:"vue-resumable",components:{InputFile:r.a},props:{inputId:{type:String},name:{type:String,default:"file"},accept:{type:String},capture:{},multiple:{type:Boolean},directory:{type:Boolean},postAction:{type:String},headers:{type:Object,default:Object},data:{type:Object,default:Object},timeout:{type:Number,default:0},promptly:{type:Boolean,default:!1},thread:{type:Number,default:1},chunkSize:{type:Number,default:0},maxRetries:{type:Number,default:3}},data:function(){return{files:[],features:a.a,uploading:0}},watch:{files:function(){if(this.promptly){this.newFileList().length&&this.upload()}}},methods:{addInputFile:function(e){if(e.files&&e.files.length)for(var t=0;t<e.files.length;t++){var n=e.files[t];this.files.push(new o.a(n,this.maxRetries))}this.$emit("change",this.files)},clear:function(){this.files=[]},newFileList:function(){var e=[];return this.files.forEach(function(t){t.uploading||e.push(t)}),e},_sendRequest:function(e){e.uploading=1;var t=[this.postAction,this.data,e,this.headers];return this.chunkSize&&(t=[].concat(i(t),[this.chunkSize,this.thread])),(new(Function.prototype.bind.apply(s.a,[null].concat(i(t))))).send()},upload:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.uploading||e){var t=this.newFileList(),n=t.length;if(n){var i=this;if(this.thread>=n)return void t.forEach(function(e){i._sendRequest(e)});for(var r=this.chunkSize?1:this.thread,a=0;a<r;a++){var o=t[a];o.uploading||i._sendRequest(o).then(function(){i.upload(!0)}).catch(function(e){e.uploadPercent=0,e.maxRetries?(e.uploading=0,--e.maxRetries):e.uploading=-1,i.upload(!0)})}}}}}}},function(e,t,n){"use strict";t.a={methods:{change:function(e){this.$destroy(),this.$parent.addInputFile(e.target),new this.constructor({parent:this.$parent,el:this.$el})}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),r={install:function(e,t){e.component(i.a.name,i.a)}};"undefined"!=typeof window&&window.Vue&&window.Vue.use(r),t.default=r},function(e,t,n){"use strict";var i=n(1),r=n(10),a=n(0),o=a(i.a,r.a,!1,null,null,null);t.a=o.exports},function(e,t,n){"use strict";var i=n(2),r=n(6),a=n(0),o=a(i.a,r.a,!1,null,null,null);t.a=o.exports},function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement;return(e._self._c||t)("input",{attrs:{type:"file",name:e.$parent.name,id:e.$parent.inputId||e.$parent.name,accept:e.$parent.accept,capture:e.$parent.capture,webkitdirectory:e.$parent.directory&&e.$parent.features.directory,directory:e.$parent.directory&&e.$parent.features.directory,multiple:e.$parent.multiple&&e.$parent.features.html5},on:{change:e.change}})},r=[],a={render:i,staticRenderFns:r};t.a=a},function(e,t,n){"use strict";t.a=new function(){var e=document.createElement("input");e.type="file",e.multiple=!0;var t={};return t.html5=window.FormData&&e.files&&!0,t.html5&&(t.directory="boolean"==typeof e.webkitdirectory||"boolean"==typeof e.directory,t.drop=void 0!==e.ondrop),t}},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(){function e(t,n){i(this,e),this.file=t,this.name=t.name,this.size=t.size,this.type=t.type,this.relativePath=t.webkitRelativePath||t.relativePath||"",this.lastModified=t.lastModified,this.lastModifiedDate=t.lastModifiedDate,this.uploadPercent=0,this.uploading=0,this.maxRetries=n||1,/^image\/*/.test(t.type)&&(this.url=this.getObjectURL(t))}return r(e,[{key:"getObjectURL",value:function(e){var t=null;return void 0!=window.createObjectURL?t=window.createObjectURL(e):void 0!=window.URL?t=window.URL.createObjectURL(e):void 0!=window.webkitURL&&(t=window.webkitURL.createObjectURL(e)),t}}]),e}();t.a=a},function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),a=function(){function e(t,n,r,a,o){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"POST",c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"json";i(this,e),this.xhr=new XMLHttpRequest,this.xhr.responseType=c,this.method=u,this.action=t,this.headers=a,this.data=n,this.file=r,this.chunkSize=1024*o,this.thread=s,this._body=new FormData}return r(e,[{key:"_setRequestHeader",value:function(){var e=this;this.headers&&Object.keys(this.headers).forEach(function(t){return e.xhr.setRequestHeader(value,e.headers[t])})}},{key:"_setCommonBodyFields",value:function(){var e=this;this.data&&Object.keys(this.data).forEach(function(t){return e._body.append(t,e.data[t])})}},{key:"_bindErrorEvent",value:function(){var e=this;this.xhr.addEventListener("error",function(){e.file.response=e.xhr.response,reject(e.file)},!1),this.xhr.addEventListener("abort",function(){e.file.response=e.xhr.response,reject(e.file)},!1)}},{key:"send",value:function(){var e=this;return this.chunkSize&&this.fileSize>this.chunkSize?this._chunkUploadSend():(this._setRequestHeader(),this._setCommonBodyFields(),new Promise(function(t,n){e._body.append(e.file.name,e.file.file),e.xhr.upload.addEventListener("progress",function(t){t.lengthComputable?e.file.uploadPercent=Math.round(100*t.loaded/t.total):e.file.uploadPercent=0},!1),e.xhr.addEventListener("load",function(){e.xhr.status>=200&&e.xhr.status<300?(e.file.uploading=2,e.file.response=e.xhr.response,t(e.file)):n(e.file)},!1),e._bindErrorEvent(),e.xhr.open(e.method,e.action,!0),e.xhr.send(e._body)}).catch(function(t){t.maxRetries&&(t.maxRetries=--t.maxRetries,e.send())}))}},{key:"_createChunkFormData",value:function(e,t,n,i){var r=this,a=new FormData;return Object.keys(this.data).forEach(function(e){return a.append(e,r.data[e])}),a.append(this.file.name,e),a.append("index",t),a.append("start",n),a.append("end",i),a}},{key:"_createChunks",value:function(){this.chunks=[];for(var e=0,t=0,n=this.chunkSize;t<this.fileSize;){var i=this.file.file.slice(t,n),r={index:e,blob:i,startOffset:t,uploading:0,retries:this.file.maxRetries};r.formData=this._createChunkFormData(r.blob,e,t,n),this.chunks.push(r),e++,t=n,n=t+this.chunkSize}console.log(this.chunks)}},{key:"_sendChunk",value:function(e){var t=this;e.uploading=1;var n=this;return new Promise(function(i,r){n.xhr=new XMLHttpRequest,n.xhr.addEventListener("load",function(){n.xhr.status>=200&&n.xhr.status<300&&(e.uploading=2,i(e))});var a=function(){e.uploading=-1,r(e)};n.xhr.addEventListener("error",a,!1),n.xhr.addEventListener("abort",a,!1),n.xhr.open(t.method,t.action,!0),n.xhr.send(e.formData)})}},{key:"_getCompleteChunkList",value:function(){var e=[];return this.chunks.forEach(function(t){2===t.uploading&&e.push(t)}),e}},{key:"_getNewChunkList",value:function(){var e=[];return this.chunks.forEach(function(t){t.uploading||e.push(t)}),e}},{key:"_sendChunkQueue",value:function(){for(var e=this._getNewChunkList(),t=this,n=e.length>this.thread?this.thread:e.length,i=0;i<n;i++)this._sendChunk(e[i]).then(function(){t.file.uploadPercent=Math.round(100*t._getCompleteChunkList().length/t.chunks.length),t._sendChunkQueue()}).catch(function(e){e.retries?(--e.retries,e.uploading=0,t._sendChunkQueue()):(t.file.uploadPercent=0,t.file.uploading=-1)})}},{key:"_chunkUploadSend",value:function(){this._createChunks(),this._sendChunkQueue()}},{key:"fileSize",get:function(){return this.file.size}}]),e}();t.a=a},function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("label",{staticClass:"className"},[e._t("default"),e._v(" "),n("input-file")],2)},r=[],a={render:i,staticRenderFns:r};t.a=a}])});
//# sourceMappingURL=vue-resumable.js.map